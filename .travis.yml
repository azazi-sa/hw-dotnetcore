language: csharp
solution: hw-dotnetcore.sln
mono: none
dotnet: 1.0.3
dist: trusty
services:
 - docker
script:
 - dotnet clean src/src.csproj
 - dotnet restore src/src.csproj
 - dotnet restore test/test.csproj
 - dotnet test test/test.csproj
 - docker build -t sameerazazi87/hw-dotnetcore:`echo $TRAVIS_BUILD_NUMBER` src/
 - docker tag sameerazazi87/hw-dotnetcore:`echo $TRAVIS_BUILD_NUMBER` sameerazazi87/hw-dotnetcore:latest
 - echo "sameerazazi87/hw-dotnetcore:`echo $TRAVIS_BUILD_NUMBER`"
 - docker images

after_success:
 - if [ "$TRAVIS_BRANCH" == "master" ]; then
   docker login -u="$DOCKER_USERNAME" -p="$DOCKER_PASSWORD";
   docker push sameerazazi87/hw-dotnetcore
   fi